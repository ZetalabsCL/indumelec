<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org"
      xmlns:layout="http://www.ultraq.net.nz/thymeleaf/layout"
      layout:decorate="~{fragments/layout}">

<th:block layout:fragment="welcome">
    <div class="row">
        <div class="col-12">
            <div class="page-title-box">
                <div class="page-title-right">
                    <ol class="breadcrumb m-0">
                        <li class="breadcrumb-item"><a href="javascript: void(0);">Home</a></li>
                        <li class="breadcrumb-item"><a href="javascript: void(0);">Administrador</a></li>
                        <li class="breadcrumb-item active">Nueva Empresa</li>
                    </ol>
                </div>
                <h4 class="page-title">Ingreso de Nueva Empresa</h4>
            </div>
        </div>
    </div>
</th:block>

<th:block layout:fragment="content">
    <form th:action="@{/admin/company/save}" method="post">
        <input th:type="hidden" name="id" th:field="${company.companyId}" />
        <div class="row">
            <div class="col-12">
                <div class="card">
                    <div class="card-body">
                        <h4 class="header-title">Datos de la empresa </h4>
                        <br>
                        <div class="row">
                            <div class="col-md-2">
                                <div class="form-group">
                                    <label for="taxid">Rut Empresa:</label>
                                    <input id="taxid" name="taxid" type="text" class="form-control" placeholder="Ingrese el Rut de la Empresa" th:field="${company.taxId}">
                                </div>
                            </div>
                            <div class="col-md-4">
                                <div class="form-group">
                                    <label for="name">Nombre de Fantas&iacute;a:</label>
                                    <input id="name" name="name" type="text" class="form-control"  placeholder="Ingrese el Apelido del Usuario" th:field="${company.name}">
                                </div>
                            </div>
                            <div class="col-md-4">
                                <div class="form-group">
                                    <label for="address">Direcci&oacute;n</label>
                                    <input id="address" name="address" type="text" class="form-control" placeholder="Ingrese Direcci&oacute;n de la Empresa" th:field="${company.address}">
                                </div>
                            </div>
                            <div class="col-md-2">
                                <div class="form-group">
                                    <label for="phone">Tel&eacute;fono:</label>
                                    <input id="phone" name="phone" type="text" class="form-control" placeholder="Ingrese Tel&eacute;fono" th:field="${company.phone}">
                                </div>
                            </div>
                        </div>

                        <div class="row">
                            <div class="col-md-4">
                                <div class="form-group">
                                    <label for="contact">Nombre Contacto:</label>
                                    <input id="contact" name="contact" type="text" class="form-control" placeholder="Ingrese el Nombre del Contacto" th:field="${company.contact}">
                                </div>
                            </div>
                            <div class="col-md-3">
                                <div class="form-group">
                                    <label for="email">E-Mail de Contacto:</label>
                                    <input id="email" name="email" type="text" class="form-control" placeholder="Ingrese el e-Mail del Contacto" th:field="${company.email}">
                                </div>
                            </div>
                            <div class="col-md-2">
                                <div class="form-group">
                                    <label for="cellphone">Celular:</label>
                                    <input id="cellphone" name="cellphone" type="text" class="form-control" placeholder="Ingrese Celular" th:field="${company.cellphone}">
                                </div>
                            </div>
                            <div class="col-md-3">
                                <div class="form-group">
                                    <label for="position">Cargo:</label>
                                    <input id="position" name="position" type="text" class="form-control" placeholder="Ingrese el cargo del contacto" th:field="${company.position}">
                                </div>
                            </div>
                        </div>

                        <div class="row">
                            <div class="col-md-2">
                                <div class="form-group">
                                    <button class="btn btn-success" name="Submit" type="Submit" th:text="'Agregar Nueva Empresa'"/>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <div class="row">
            <div class="col-12">
                <div class="card">
                    <div class="card-body">
                        <h4 class="header-title">Empresas Existentes</h4>
                        <p class="text-muted font-14">
                            Listado de Empresas existentes, habilitadas para usarlas en el sistema de cotizaci&oacute;n
                        </p>

                        <div class="row">
                            <div class="col-12">
                                <h4 class="header-title"></h4>
                                <div class="table-responsive">
                                    <table id="empresas-table" class="table mt-4">
                                        <thead>
                                        <tr>
                                            <th>#</th>
                                            <th>Empresa</th>
                                            <th>Rut</th>
                                            <th>Contacto</th>
                                            <th class="text-right">Editar / Eliminar</th>
                                        </tr>
                                        </thead>
                                    </table>
                                </div>
                            </div>
                        </div>

                        <div id="delete-modal" class="modal fade" tabindex="-1" role="dialog" aria-hidden="true">
                            <div class="modal-dialog modal-sm">
                                <div class="modal-content modal-filled bg-danger">
                                    <div class="modal-body p-4">
                                        <div class="text-center">
                                            <i class="dripicons-wrong h1"></i>
                                            <h4 class="mt-2">Empresa elimnada correctamente!</h4>
                                            <p class="mt-3">La Empresa seleccionada, fue eliminada correctamente.</p>
                                            <button type="button" class="btn btn-light my-2" data-dismiss="modal">Aceptar</button>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </form>
</th:block>

<th:block layout:fragment="script">
    <script>
        $(document).ready(function() {
            $('#empresas-table').DataTable( {
                responsive: true,
                ajax: '/api/company/list',
                columns: [
                    {'data': 'companyId'},
                    {'data': 'name'},
                    {'data': 'taxId'},
                    {'data': 'contact'},
                    {
                        'data': 'companyId',
                        'searchable': false,
                        'sortable': false,
                        'fnCreatedCell': function (nTd, sData, oData, iRow, iCol) {
                            $(nTd).addClass('text-right');
                            $(nTd).html(
                                '<a id="edit" href="/admin/company/edit/' + oData.companyId + '" class="btn btn-warning"><i class="mdi mdi-comment-processing-outline"></i> Editar</a> - ' +
                                '<a id="delete" href="/admin/company/delete/' + oData.companyId + '" class="btn btn-danger"><i class="mdi mdi-comment-remove-outline"></i> Eliminar</a>');
                        }
                    }
                ],
                dom: "<'row'<'col-sm-3'l><'col-sm-6 botones text-center'B><'col-sm-3'f>>" +
                    "<'row'<'col-sm-12'tr>>" +
                    "<'row'<'col-sm-7'i><'col-sm-5'p>>",
                buttons: [
                    {
                        extend: 'excel',
                        text: 'Excel',
                        className: 'btn btn-default',
                        title: 'Empresas',
                        exportOptions: {
                            columns: ':visible:not(:last-child)'
                        }
                    },
                    {
                        extend: 'pdf',
                        text: 'Pdf',
                        className: 'btn btn-default',
                        title: 'Empresas',
                        exportOptions: {
                            columns: ':visible:not(:last-child)'
                        }
                    }
                ],
                language: {
                    lengthMenu: "Mostrando _MENU_ registros por p&aacute;gina",
                    zeroRecords: "Sin resultados - lo siento!",
                    info: "Mostrando p&aacute;gina _PAGE_ de _PAGES_",
                    infoEmpty: "No hay registros disponibles",
                    search: "Buscar",
                    infoFiltered: "(filtrados de _MAX_ registros totales)",
                    paginate: {
                        previous: "Anterior",
                        next: "Siguiente"
                    }
                }
            });
        });
    </script>
</th:block>
</html>